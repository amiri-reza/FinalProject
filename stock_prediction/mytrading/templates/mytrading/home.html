{% extends 'base.html' %}
{% load i18n %}
{% block title %}{% trans "Homepage" %}{% endblock %}
{% load static %}
{% block content %}
{% load widget_tweaks %}

<!-- MESSAGE SECTION -->
{% if messages %}
<div class="container mt-3">
  {% for message in messages %}
  <div class="alert alert-dismissible alert-primary">
    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
    {{message}}
  </div>
  {% endfor %}
</div>
{% endif %}

<!-- TICKER SEARCH -->
<div class="mt-5 text-center">
  <form action="" method="post" class="align-items-center justify-content-center row">
    {% csrf_token %}
    <div class="form-floating d-flex col-md-6 align-items-center">
      <input type="text" class="form-control mb-0" name="{{ form.ticker.name }}" id="{{ form.ticker.id_for_label }}" required>
      <label for="{{ form.ticker.id_for_label }}">Stock Symbol</label>
    </div>
    <button type="submit" class="btn btn-primary col-md-1 col-2 mt-3 mt-md-0"
    style="height: 56px;">
      Search
    </button>
  </form>
</div>

<!-- PLOT SECTION -->
{% autoescape off %}
{{ plt_div }}
{% endautoescape %}

<!-- TICKER INFORMATION -->
{% if ticker %}
<div class="container mt-5">
  <h2 class="text-center mb-4">{{ company }} Stock Overview</h2>
  <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4">
    <div class="col">
      <div class="card h-100 card-gradient-l">
        <div class="card-body">
          <h5 class="card-title">Currency</h5>
          <p class="card-text">{{ ticker.fast_info.currency }}</p>
        </div>
      </div>
    </div>
    <div class="col">
      <div class="card h-100 card-gradient-m">
        <div class="card-body">
          <h5 class="card-title">Day High</h5>
          <p class="card-text">{{ ticker.fast_info.dayHigh }}</td>
        </div>
      </div>
    </div>
    <div class="col">
      <div class="card h-100 card-gradient-r">
        <div class="card-body">
          <h5 class="card-title">Day Low</h5>
          <p class="card-text">{{ ticker.fast_info.dayLow }}</td>
        </div>
      </div>
    </div>
    <div class="col">
      <div class="card h-100 card-gradient-l">
        <div class="card-body">
          <h5 class="card-title">Exchange</h5>
          <p class="card-text">{{ ticker.fast_info.exchange }}</td>
        </div>
      </div>
    </div>
    <div class="col">
      <div class="card h-100 card-gradient-m">
        <div class="card-body">
          <h5 class="card-title">50 Day Average</h5>
          <p class="card-text">{{ ticker.fast_info.fiftyDayAverage }}</td>
        </div>
      </div>
    </div>
    <div class="col">
      <div class="card h-100 card-gradient-r">
        <div class="card-body">
          <h5 class="card-title">Last Price</h5>
          <p class="card-text">{{ ticker.fast_info.lastPrice }}</td>
        </div>
      </div>
    </div>
    <div class="col">
      <div class="card h-100 card-gradient-l">
        <div class="card-body">
          <h5 class="card-title">Last Volume</h5>
          <p class="card-text">{{ ticker.fast_info.lastVolume }}</td>
        </div>
      </div>
    </div>
    <div class="col">
      <div class="card h-100 card-gradient-m">
        <div class="card-body">
          <h5 class="card-title">Market Cap</h5>
          <p class="card-text">{{ ticker.fast_info.marketCap }}</td>
        </div>
      </div>
    </div>
    <div class="col">
      <div class="card h-100 card-gradient-r">
        <div class="card-body">
          <h5 class="card-title">Open</h5>
          <p class="card-text">{{ ticker.fast_info.open }}</td>
        </div>
      </div>
    </div>
    <div class="col">
      <div class="card h-100 card-gradient-l">
        <div class="card-body">
          <h5 class="card-title">Previous Close</h5>
          <p class="card-text">{{ ticker.fast_info.previousClose }}</td>
        </div>
      </div>
    </div>
    <div class="col">
      <div class="card h-100 card-gradient-m">
        <div class="card-body">
          <h5 class="card-title">Quote Type</h5>
          <p class="card-text">{{ ticker.fast_info.quoteType }}</td>
        </div>
      </div>
    </div>
    <div class="col">
      <div class="card h-100 card-gradient-r">
        <div class="card-body">
          <h5 class="card-title">Regular Market Previous Close</h5>
          <p class="card-text">{{ ticker.fast_info.regularMarketPreviousClose }}</td>
        </div>
      </div>
    </div>
    <div class="col">
      <div class="card h-100 card-gradient-l">
        <div class="card-body">
          <h5 class="card-title">Shares</h5>
          <p class="card-text">{{ ticker.fast_info.shares }}</td>
        </div>
      </div>
    </div>
    <div class="col">
      <div class="card h-100 card-gradient-m">
        <div class="card-body">
          <h5 class="card-title">10 Day Average Volume</h5>
          <p class="card-text">{{ ticker.fast_info.tenDayAverageVolume }}</td>
        </div>
      </div>
    </div>
    <div class="col">
      <div class="card h-100 card-gradient-r">
        <div class="card-body">
          <h5 class="card-title">3 Month Average Volume</h5>
          <p class="card-text">{{ ticker.fast_info.threeMonthAverageVolume }}</td>
        </div>
      </div>
    </div>
    <div class="col">
      <div class="card h-100 card-gradient-l">
        <div class="card-body">
          <h5 class="card-title">Timezone</h5>
          <p class="card-text">{{ ticker.fast_info.timezone }}</td>
        </div>
      </div>
    </div>
    <div class="col">
      <div class="card h-100 card-gradient-m">
        <div class="card-body">
          <h5 class="card-title">200 Day Average</h5>
          <p class="card-text">{{ ticker.fast_info.twoHundredDayAverage }}</td>
        </div>
      </div>
    </div>
    <div class="col">
      <div class="card h-100 card-gradient-r">
        <div class="card-body">
          <h5 class="card-title">Year Change</h5>
          <p class="card-text">{{ ticker.fast_info.yearChange }}</td>
        </div>
      </div>
    </div>
    <div class="col">
      <div class="card h-100 card-gradient-l">
        <div class="card-body">
          <h5 class="card-title">Year High</h5>
          <p class="card-text">{{ ticker.fast_info.yearHigh }}</td>
        </div>
      </div>
    </div>
    <div class="col">
      <div class="card h-100 card-gradient-m">
        <div class="card-body">
          <h5 class="card-title">Year Low</h5>
          <p class="card-text">{{ ticker.fast_info.yearLow }}</p>
        </div>
      </div>
    </div>
  </div>
</div>
{% else %}
<hr>
<h1 class="text-center card card-gradient-l">WELCOME! {{ user.first_name }}</h1>
{% endif %}

<!-- TICKER NEWS -->
{% if ticker.news %}
<div class="container mt-5">
  <h2>News:</h2>
  {% for new in ticker.news %}
  <div class="card mb-3 card-gradient-l">
    <div class="card-body">
      <h5 class="card-title">{{ new.title }}</h5>
      <h6 class="card-subtitle mb-2 text-muted">{{ new.publisher }}</h6>
      <a href="{{ new.link }}" class="card-link" target="_blank">Read more</a>
    </div>
  </div>
  {% endfor %}
</div>
{% endif %}

{% endblock %}


