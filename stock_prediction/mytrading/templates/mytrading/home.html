{% extends 'base.html' %}
{% load i18n %}
{% block title %}{% trans "Homepage" %}{% endblock %}
{% load static %}
{% block content %}
{% load widget_tweaks %}
<style>
  .alert {
  padding: 5px;
  background-color: #8214a3;
  color: white;
}

.closebtn {
  margin-left: 0px;
  color: white;
  font-weight: bold;
  float: right;
  font-size: 22px;
  line-height: 20px;
  cursor: pointer;
  transition: 0.3s;
}

.closebtn:hover {
  color: black;
}
</style>

<!-- MESSAGE SECTION -->
{% if messages %}
<div>
  <ul>
    {% for message in messages %}
    <div class="alert">
      <span class="closebtn" onclick="this.parentElement.style.display='none';">&times;</span> 
      <li>{{message}}</li>
    </div>
    {% endfor %}
  </ul>
</div>
{% endif %}

<!-- TICKER SEARCH -->
<div class="mt-5 text-center">
  <form action="" method="post" class="align-items-center justify-content-center row">
    {% csrf_token %}
    <div class="form-floating d-flex col-md-6 align-items-center">
      <input type="text" class="form-control mb-0" name="{{ form.ticker.name }}" id="{{ form.ticker.id_for_label }}" required>
      <label for="{{ form.ticker.id_for_label }}">Stock Symbol</label>
    </div>
    <button type="submit" class="btn btn-primary col-md-1 col-2 mt-3 mt-md-0"
    style="height: 56px;">
      Search
    </button>
  </form>
</div>

<!-- PLOT SECTION -->
{% autoescape off %}
{{ plt_div }}
{% endautoescape %}

<!-- TICKER INFORMATION -->
{% if ticker %}
<h2>Stock Overview</h2>
<div class="table-responsive-sm">
  <table class="table table-striped table-sm">
    <tr>
    <th>Currency</th>
    <td>{{ ticker.fast_info.currency }}</td>
    </tr>
    <tr>
    <th>Day High</th>
    <td>{{ ticker.fast_info.dayHigh }}</td>
    </tr>
    <tr>
    <th>Day Low</th>
    <td>{{ ticker.fast_info.dayLow }}</td>
    </tr>
    <tr>
    <th>Exchange</th>
    <td>{{ ticker.fast_info.exchange }}</td>
    </tr>
    <tr>
    <th>50 Day Average</th>
    <td>{{ ticker.fast_info.fiftyDayAverage }}</td>
    </tr>
    <tr>
    <th>Last Price</th>
    <td>{{ ticker.fast_info.lastPrice }}</td>
    </tr>
    <tr>
    <th>Last Volume</th>
    <td>{{ ticker.fast_info.lastVolume }}</td>
    </tr>
    <tr>
    <th>Market Cap</th>
    <td>{{ ticker.fast_info.marketCap }}</td>
    </tr>
    <tr>
    <th>Open</th>
    <td>{{ ticker.fast_info.open }}</td>
    </tr>
    <tr>
    <th>Previous Close</th>
    <td>{{ ticker.fast_info.previousClose }}</td>
    </tr>
    <tr>
    <th>Quote Type</th>
    <td>{{ ticker.fast_info.quoteType }}</td>
    </tr>
    <tr>
    <th>Regular Market Previous Close</th>
    <td>{{ ticker.fast_info.regularMarketPreviousClose }}</td>
    </tr>
    <tr>
    <th>Shares</th>
    <td>{{ ticker.fast_info.shares }}</td>
    </tr>
    <tr>
    <th>10 Day Average Volume</th>
    <td>{{ ticker.fast_info.tenDayAverageVolume }}</td>
    </tr>
    <tr>
    <th>3 Month Average Volume</th>
    <td>{{ ticker.fast_info.threeMonthAverageVolume }}</td>
    </tr>
    <tr>
    <th>Timezone</th>
    <td>{{ ticker.fast_info.timezone }}</td>
    </tr>
    <tr>
    <th>200 Day Average</th>
    <td>{{ ticker.fast_info.twoHundredDayAverage }}</td>
    </tr>
    <tr>
    <th>Year Change</th>
    <td>{{ ticker.fast_info.yearChange }}</td>
    </tr>
    <tr>
    <th>Year High</th>
    <td>{{ ticker.fast_info.yearHigh }}</td>
    </tr>
    <tr>
    <th>Year Low</th>
    <td>{{ ticker.fast_info.yearLow }}</td>
    </tr>
    <tr>
    </tbody>
  </table>
</div>
{% else %}
<hr>
<h1>WELCOME! {{ user.first_name }}</h1>
{% endif %}
<hr>

<!-- TICKER NEWS -->
{% if ticker.news %}
<h2> News: </h2>
{% for new in ticker.news %}
<ul>
  <li>Title: {{ new.title }}</li>
  <li>Publisher: {{ new.title }}</li>
  <li>Link: <a href="{{ new.link }}"> Click to go to the external link </a></li>
</ul>
<hr>
{% endfor %}
{% endif %}

{% endblock %}
